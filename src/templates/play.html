<!DOCTYPE html>
<html>
  <head>
    <script src="//www.rdio.com/api/api.js?client_id=VbZ4G9Z-2iTpsUomxNh68w"></script>
    <script type="text/javascript">
      var trackName = '{{ trackData["title"] }}';
      var artist = '{{ trackData["artist"]["name"] }}';

      var playSong = function () {
      R.request({
                method: "search",
                content: {
                        types: "Track",
                        count: 1,
                        query: trackName + ", " + artist
                },
                success: function(response) {
                        var top = response.result.results[0];
                        console.log(top.name + " by " + top.artist);
                        R.player.play({source: top.key});
                },
                error: function(response) {
                        console.log("error: " + response.message);
                }
            });
      };

      R.ready(function() {
        if(!R.authenticated()) {
          R.authenticate(function (authenticated) {
          if (authenticated) {
            playSong();
          }
        });
      }
      else {
          playSong();
      }
        
      });

    </script>
  </head>
  <body>
  </body>
</html>
